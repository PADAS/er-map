(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),o=a(3),l=a.n(o),c=a(4),r=a(2),s=a.n(r);var m=({subject:e})=>{const{displayTracks:t,setTracks:a,tracks:o}=Object(n.useContext)(f),l=!!o[e.id],c=l?"/public/images/button_icons/pin_tracks-green.png":"/public/images/button_icons/pin_tracks-gray.png";return i.a.createElement("img",{width:"24",height:"24",className:"hover",src:c,id:"subject-track-button",onClick:()=>{const n=[e.id,!l],i=Object.assign({},o);i[n[0]]=n[1],a(i),t(n)}})};var d=e=>{const t=e.subjectData,a=e.subject,{legendOpen:n,onLegendStateToggle:o}=e;let l,c="";void 0!==a.sex&&(c=a.sex.charAt(0).toUpperCase()+a.sex.slice(1)+" | "),l=null===a.common_name?a.subject_subtype.replace(/\b\w/g,e=>e.toUpperCase()):a.common_name.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase());let r=a.last_position.properties.DateTime;r=r.substring(0,10)+" "+r.substring(11,16);let s={display:"flex"};a.display_story||(s={display:"none"});return i.a.createElement("div",{id:"pop-up"},i.a.createElement("div",null,function(){if(void 0!==t&&void 0!==t.pictures&&t.pictures.length>0)return i.a.createElement("img",{className:"pop-up-image",src:t.pictures[0].path,alt:"picture"})}()),i.a.createElement("div",{id:"pop-up-header"},i.a.createElement("h3",null,a.name)),i.a.createElement("p",null,c,t&&t.age&&t.age+" |"," ",l),t&&t.fun_fact&&i.a.createElement("p",null,i.a.createElement("i",null,t.fun_fact)),i.a.createElement("div",{onClick:()=>{e.onStoryClick([a,t]),n||o()},className:"hover",style:s,id:"view-story-button"},i.a.createElement("p",null,"View my story"),i.a.createElement("img",{height:"10",id:"story",src:"/public/images/button_icons/caret-right-orange.png"})),i.a.createElement("div",{id:"pop-up-buttons"},i.a.createElement("p",{id:"date"},r),i.a.createElement(m,{subject:a})))};var p=({children:e,coordinates:t,onClose:a})=>{const i=Object(n.useRef)(new s.a.Popup({closeButton:!1}));return Object(n.useEffect)(()=>{const e=i.current;return e.addTo(window.GlobalMap),()=>e.remove()},[]),Object(n.useEffect)(()=>{i.current.setLngLat(t)},[i,t]),Object(n.useEffect)(()=>{const e=i.current;return e.on("close",a),()=>e.off("close",a)},[i,a]),Object(n.useEffect)(()=>{const t=document.createElement("div");l.a.render(e,t),i.current.setDOMContent(t)},[i,e]),null};var u=({subject:e,handleOnLocButtonClicked:t})=>i.a.createElement(i.a.Fragment,null,i.a.createElement("img",{width:"24",height:"24",className:"hover",src:"/public/images/button_icons/map_pin-gray.png",id:"subject-location-button",onClick:()=>{t(e.last_position.geometry.coordinates)}}));var g=({animal:e,configData:t,animalOnLocClicked:a,onNameClick:n,displayStory:o,tracks:l})=>{const c={backgroundColor:e.color},r=e.id+" animal";let s="hover",d="animal-name ",p={},g=e.name;g.length>15&&(g=g.substring(0,15)+"...");let b="";return void 0!==l&&l&&(b=" bold "),void 0!==t&&o||(s="default",d="",p={visibility:"hidden"}),i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"animal-legend-content",onClick:a=>{const i=document.getElementById(r),o=a.target;i.classList.contains("animal-name")&&"subject-track-button"!==o.id&&"subject-location-button"!==o.id&&(n([e,t.subjects[e.id]]),i.classList.toggle("animal-name"),i.classList.toggle("hover"))}},i.a.createElement("div",{id:"animal-color",style:c}),i.a.createElement("div",{className:"fit-content "+d+s,id:r}),i.a.createElement("div",{id:"animal-color"}),i.a.createElement("div",{className:"animal-name-bullet "+d+s,id:r},i.a.createElement("div",{id:"animal-bullet"},i.a.createElement("div",{style:c})),i.a.createElement("div",{className:"animal-name-style "+s+b,id:e.name.replace(" ","-")},g)),i.a.createElement("div",{id:"track-buttons",className:s},i.a.createElement(m,{subject:e,trackState:l}),i.a.createElement(u,{subject:e,handleOnLocButtonClicked:a})),i.a.createElement("img",{id:"story-button",className:s,style:p,width:"7px",height:"10px",src:"/public/images/button_icons/story-f.png"})))};var b=({subs:e,subjectData:t,onLocClick:a,legSub:n,onReturnClick:o,onStoryClick:l,legendOpen:c,onLegendStateToggle:r,tracks:s,title:m})=>{const d=c?"./public/images/button_icons/double_caret-right.png":"/public/images/button_icons/double_caret-left.png";return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{id:"legend",className:c?"legend-open":"legend-close"},i.a.createElement("div",{id:"legend-open-button",onClick:()=>{r()}},i.a.createElement("img",{src:d})),void 0===n?i.a.createElement("div",{id:"legend-content"},i.a.createElement("div",{className:"title"},i.a.createElement("div",{id:"earthranger-logo"},i.a.createElement("a",{href:"https://earthranger.com/",rel:"noreferrer",target:"_blank",className:"earthranger-logo"},i.a.createElement("img",{src:"./public/images/LogoEarthRanger.png"}))),i.a.createElement("div",{id:"tracker"},i.a.createElement("p",null,null!==m?m:"Animal Tracker"))),i.a.createElement("div",{id:"subs"},void 0===e?i.a.createElement("div",null):e.map(e=>i.a.createElement("div",{key:e.id,id:"subject-div"},i.a.createElement(g,{animal:e,configData:t,key:e.id,animalOnLocClicked:a,onNameClick:l,displayStory:e.display_story,tracks:s[e.id]}))))):i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{id:"legend-content"},i.a.createElement("div",{className:"title"},i.a.createElement("div",{id:"earthranger-logo"},i.a.createElement("a",{href:"https://earthranger.com/",className:"earthranger-logo"},i.a.createElement("img",{src:"./public/images/LogoEarthRanger.png"}))),i.a.createElement("div",{id:"tracker"},i.a.createElement("p",null,null!==m?m:"Animal Tracker"))),i.a.createElement("div",{onClick:()=>o(void 0),id:"return",className:"hover"},i.a.createElement("img",{width:"7px",height:"10px",src:"./public/images/button_icons/view-animals-caret-left.png"}),i.a.createElement("p",null,"Back")),i.a.createElement("div",{id:"animal-story"},i.a.createElement("div",{id:"subject-div"},i.a.createElement(g,{animal:n[0],key:n[0].id,animalOnLocClicked:a,tracks:s[n[0].id]})),n[1].pictures.map(e=>i.a.createElement("img",{className:"sub-image",key:e,src:e.path,height:200,width:200,alt:"picture"})),i.a.createElement("div",{id:"sub-content",className:"default",dangerouslySetInnerHTML:{__html:n[1].detail_description}}))))))};var h=()=>{const e="/public/images/button_icons/tips-gray.png",t="/public/images/button_icons/tips-green.png",[a,o]=Object(n.useState)(e),l={marginBottom:"2px",marginTop:"0px"};return i.a.createElement("div",{id:"tips-container"},i.a.createElement("div",{id:"tips-button-container",className:"hover",onClick:()=>{document.getElementById("tips").classList.toggle("hidden"),o(a===e?t:e)}},i.a.createElement("img",{id:"help-button",src:a})),i.a.createElement("div",{id:"tips",className:"hidden"},i.a.createElement("div",null,i.a.createElement("h2",null,"Helpful Tips"),i.a.createElement("img",{id:"close-icon",src:"/public/images/button_icons/close-icon.png",onClick:()=>{o(a===e?t:e);document.getElementById("tips").classList.add("hidden")}})),i.a.createElement("div",{id:"actual-tips"},i.a.createElement("div",null,i.a.createElement("img",{width:"20",height:"40",style:{paddingLeft:"2px"},src:"/public/images/button_icons/tip-zoom.png"}),i.a.createElement("p",{style:{marginTop:"10px"}},"Zoom map in/out")),i.a.createElement("div",null,i.a.createElement("img",{width:"24",style:{marginTop:"8px"},height:"24",src:"/public/images/button_icons/tip-reset.png"}),i.a.createElement("p",{style:l},"Return map orientation to original view")),i.a.createElement("div",null,i.a.createElement("img",{width:"24",height:"24",style:{marginTop:"6px"},src:"/public/images/button_icons/tip-control_key.png"}),i.a.createElement("p",{style:l},"Hold Ctrl / control key and drag with mouse to rotate view")),i.a.createElement("div",null,i.a.createElement("img",{width:"24",height:"24",src:"/public/images/button_icons/map_pin-gray.png"}),i.a.createElement("p",null,"Jump to a subject's location")),i.a.createElement("div",null,i.a.createElement("img",{width:"24",height:"24",src:"/public/images/button_icons/pin_tracks-gray.png"}),i.a.createElement("p",null,"Display a subject's track")),i.a.createElement("div",null,i.a.createElement("img",{width:"7",height:"10",style:{paddingLeft:"9px",paddingRight:"8px",marginTop:"5px"},src:"/public/images/button_icons/story-f.png"}),i.a.createElement("p",null,"Display a subject's story")))))};a(14);let E;s.a.accessToken="pk.eyJ1IjoidmpvZWxtIiwiYSI6ImNra2hiZXNpMzA1bTcybnA3OXlycnN2ZjcifQ.gH6Nls61WTMVutUH57jMJQ";const y={},v=["#003744","#005B70","#219DB8","#05C1EA","#60E1FF","#2E8E96","#47C6B1","#91E8DA"],w=["#511913","#711E17","#961F1A","#DB2222","#E5632E","#E67931","#E69E39","#D2B541","#BFBD48"];window.GlobalMap=null;const f=Object(n.createContext)({});var k=e=>{var[t,a]=Object(n.useState)([]),[o,l]=Object(n.useState)({}),[r,m]=Object(n.useState)({}),[u,g]=Object(n.useState)(void 0);const[k,j]=Object(n.useState)([]),[_,C]=Object(n.useState)(!0),x=()=>{C(!_)};function L(){c.a.initialize("UA-128569083-10"),c.a.pageview(window.location.pathname+window.location.search),window.GlobalMap=new s.a.Map({container:"map-container",style:"mapbox://styles/mapbox/satellite-v9",center:E.map.center?E.map.center:[-109.3666652,-27.1166662],zoom:E.map.zoom?E.map.zoom:11,pitch:E.map.pitch?E.map.pitch:75});var e=new s.a.NavigationControl({visualizePitch:!0});window.GlobalMap.addControl(e,"top-left"),window.GlobalMap.on("load",(function(){window.GlobalMap.addSource("mapbox-dem",{type:"raster-dem",url:"mapbox://mapbox.mapbox-terrain-dem-v1",tileSize:512,maxzoom:23}),window.GlobalMap.addLayer({id:"sky",type:"sky",paint:{"sky-type":"atmosphere","sky-atmosphere-sun":[0,0],"sky-atmosphere-sun-intensity":15}}),window.GlobalMap.on("render",(function(){window.GlobalMap.setTerrain({source:"mapbox-dem",exaggeration:3})}));const e=`https://${E.server}/api/v1.0/subjects`;fetch(e).then(e=>{if(e.ok)return e;throw Error("Error in request:"+e.statusText)}).then(e=>e.json()).then(e=>{let t=0;e.data.data.map(e=>{void 0!==e.last_position&&(E.subjects[e.id]&&E.subjects[e.id].name&&(e.name=E.subjects[e.id].name),async function(e){let t=null;t=E.subjects[e.id]&&E.subjects[e.id].icon?E.subjects[e.id].icon:null!==e.common_name&&await async function(e){try{return 404!==(await fetch(e)).status}catch(e){return!1}}(`public/images/animal_icons/${e.common_name}.png`)?`public/images/animal_icons/${e.common_name}.png`:e.last_position.properties.image;!function(e,t){window.GlobalMap.loadImage(t,(function(a,n){if(a)throw a;window.GlobalMap.addImage(e.subject_subtype+e.id,n),window.GlobalMap.addSource("point"+e.id,{type:"geojson",data:e.last_position}),window.GlobalMap.addLayer({id:"points"+e.id,type:"symbol",source:"point"+e.id,layout:{"icon-image":e.subject_subtype+e.id,"icon-size":t!==e.last_position.properties.image?.4:1,"icon-anchor":"bottom","text-field":e.name,"text-size":15,"text-offset":[0,.3],"text-anchor":"top"},paint:{"text-color":"white"}}),window.GlobalMap.on("click","points"+e.id,t=>{for(var a=t.features[0].geometry.coordinates.slice();Math.abs(t.lngLat.lng-a[0])>180;)a[0]+=t.lngLat.lng>a[0]?360:-360;j([...k,{geometry:t.features[0].geometry,properties:e}])}),window.GlobalMap.on("mouseenter","points"+e.id,()=>{window.GlobalMap.getCanvas().style.cursor="pointer"}),window.GlobalMap.on("mouseleave","points"+e.id,()=>{window.GlobalMap.getCanvas().style.cursor=""})}))}(e,t)}(e).then());let a=w;E.color_scheme&&(a="earthtones"===E.color_scheme?w:"aquatic"===E.color_scheme?v:E.color_scheme),e.color=a[t%a.length],t++;const n=r;n[e.id]=e.color,m(n)});for(let t=0;t<e.data.data.length;t++){const a=e.data.data[t].id;e.data.data[t].display_story=E.subjects[a]&&(E.subjects[a].pictures||E.subjects[a].detail_description)}a(e.data.data)}).catch(console.error)}))}function M(e){const t=e[0],a=e[1],n=window.GlobalMap.getLayer("LineString "+t);a?void 0===n?function(e){const t=`https://${E.server}/api/v1.0/subject/`+e+"/tracks";fetch(t).then(e=>{if(e.ok)return e;throw Error("Error in request:"+e.statusText)}).then(e=>e.json()).then(t=>{!function(e,t){window.GlobalMap.addSource(e.features[0].geometry.type+" "+e.features[0].properties.id,{type:"geojson",data:e}),window.GlobalMap.addLayer({id:e.features[0].geometry.type+" "+e.features[0].properties.id,type:"line",source:e.features[0].geometry.type+" "+e.features[0].properties.id,layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":r[t],"line-width":3}})}(t.data,e)}).catch(console.error)}(t):window.GlobalMap.setLayoutProperty("LineString "+t,"visibility","visible"):window.GlobalMap.setLayoutProperty("LineString "+t,"visibility","none")}Object(n.useEffect)(()=>{let t=!0;return fetch(e.configFile,{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(e=>e.json()).then(e=>{t&&(E=e,L())}),function(){t=!1}},[]);const T=e=>{82!==e.keyCode&&18!==e.keyCode||(y[e.keyCode]="keydown"===e.type,y[82]&&y[18]&&S())},S=()=>{window.GlobalMap.flyTo({center:E.map.center?E.map.center:[-109.3666652,-27.1166662],zoom:E.map.zoom?E.map.zoom:11,pitch:E.map.pitch?E.map.pitch:75,essential:!0,bearing:0})};return i.a.createElement(i.a.Fragment,null,i.a.createElement(f.Provider,{value:{displayTracks:M,setTracks:l,tracks:o}},i.a.createElement("div",{id:"map-container",onKeyDown:T,onKeyUp:T},i.a.createElement(h,null),i.a.createElement(b,{title:void 0!==E?E.map_title:null,subs:t,subjectData:E,onLocClick:e=>function(e){window.GlobalMap.flyTo({center:e,zoom:15,essential:!0})}(e),legendOpen:_,onLegendStateToggle:x,legSub:u,onReturnClick:e=>g(e),onStoryClick:e=>g(e),tracks:o})),k.map(({properties:t,geometry:a})=>i.a.createElement(p,{key:t.id+"-popup",onClose:()=>{j(k.filter(({properties:{id:e}})=>e!==t.id))},coordinates:a.coordinates.slice()},i.a.createElement(f.Provider,{value:{displayTracks:M,setTracks:l,tracks:o}},i.a.createElement(d,{subject:t,subjectData:E.subjects[t.id],onStoryClick:e=>g(e),legendOpen:_,onLegendStateToggle:x,...e})))))," ")};Object(o.render)(i.a.createElement(k,{configFile:"./public/config/config.json"}),document.getElementById("root"))},6:function(e,t,a){e.exports=a(15)}},[[6,1,2]]]);